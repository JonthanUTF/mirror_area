<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="803px" preserveAspectRatio="none" style="width:873px;height:803px;" version="1.1" viewBox="0 0 873 803" width="873px" zoomAndPan="magnify"><defs><filter height="300%" id="f1smdt1z92i7ki" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacingAndGlyphs" textLength="296" x="289.75" y="29.2419">Architecture - High Level Sequence</text><rect fill="#FFFFFF" filter="url(#f1smdt1z92i7ki)" height="320.0602" style="stroke: #000000; stroke-width: 2.0;" width="520.5" x="342" y="376.5259"/><rect fill="#FFFFFF" filter="url(#f1smdt1z92i7ki)" height="222.9421" style="stroke: #000000; stroke-width: 2.0;" width="500.5" x="352" y="466.6439"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="26" x2="26" y1="127.5838" y2="713.586"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="182" x2="182" y1="127.5838" y2="713.586"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="287" x2="287" y1="127.5838" y2="713.586"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="432" x2="432" y1="127.5838" y2="713.586"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="583" x2="583" y1="127.5838" y2="713.586"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="754.5" x2="754.5" y1="127.5838" y2="713.586"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="31" x="8" y="123.4818">User</text><ellipse cx="26.5" cy="51.5158" fill="#FEFECE" filter="url(#f1smdt1z92i7ki)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M26.5,59.5158 L26.5,86.5158 M13.5,67.5158 L39.5,67.5158 M26.5,86.5158 L13.5,101.5158 M26.5,86.5158 L39.5,101.5158 " fill="none" filter="url(#f1smdt1z92i7ki)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="31" x="8" y="727.552">User</text><ellipse cx="26.5" cy="741.654" fill="#FEFECE" filter="url(#f1smdt1z92i7ki)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M26.5,749.654 L26.5,776.654 M13.5,757.654 L39.5,757.654 M26.5,776.654 L13.5,791.654 M26.5,776.654 L39.5,791.654 " fill="none" filter="url(#f1smdt1z92i7ki)" style="stroke: #A80036; stroke-width: 2.0;"/><rect fill="#FEFECE" filter="url(#f1smdt1z92i7ki)" height="33.0679" style="stroke: #A80036; stroke-width: 1.5;" width="83" x="139" y="89.5158"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="69" x="146" y="111.4818">WebClient</text><rect fill="#FEFECE" filter="url(#f1smdt1z92i7ki)" height="33.0679" style="stroke: #A80036; stroke-width: 1.5;" width="83" x="139" y="712.586"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="69" x="146" y="734.552">WebClient</text><rect fill="#FEFECE" filter="url(#f1smdt1z92i7ki)" height="33.0679" style="stroke: #A80036; stroke-width: 1.5;" width="99" x="236" y="89.5158"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="85" x="243" y="111.4818">MobileClient</text><rect fill="#FEFECE" filter="url(#f1smdt1z92i7ki)" height="33.0679" style="stroke: #A80036; stroke-width: 1.5;" width="99" x="236" y="712.586"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="85" x="243" y="734.552">MobileClient</text><rect fill="#FEFECE" filter="url(#f1smdt1z92i7ki)" height="33.0679" style="stroke: #A80036; stroke-width: 1.5;" width="137" x="362" y="89.5158"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="123" x="369" y="111.4818">Application Server</text><rect fill="#FEFECE" filter="url(#f1smdt1z92i7ki)" height="33.0679" style="stroke: #A80036; stroke-width: 1.5;" width="137" x="362" y="712.586"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="123" x="369" y="734.552">Application Server</text><rect fill="#FEFECE" filter="url(#f1smdt1z92i7ki)" height="33.0679" style="stroke: #A80036; stroke-width: 1.5;" width="77" x="543" y="89.5158"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="63" x="550" y="111.4818">Database</text><rect fill="#FEFECE" filter="url(#f1smdt1z92i7ki)" height="33.0679" style="stroke: #A80036; stroke-width: 1.5;" width="77" x="543" y="712.586"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="63" x="550" y="734.552">Database</text><rect fill="#FEFECE" filter="url(#f1smdt1z92i7ki)" height="33.0679" style="stroke: #A80036; stroke-width: 1.5;" width="172" x="666.5" y="89.5158"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="158" x="673.5" y="111.4818">ExternalService (OAuth)</text><rect fill="#FEFECE" filter="url(#f1smdt1z92i7ki)" height="33.0679" style="stroke: #A80036; stroke-width: 1.5;" width="172" x="666.5" y="712.586"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="158" x="673.5" y="734.552">ExternalService (OAuth)</text><polygon fill="#A80036" points="170.5,157.2898,180.5,161.2898,170.5,165.2898,174.5,161.2898" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="26.5" x2="176.5" y1="161.2898" y2="161.2898"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="132" x="33.5" y="155.4808">open UI / Create AREA</text><polygon fill="#A80036" points="420.5,188.9958,430.5,192.9958,420.5,196.9958,424.5,192.9958" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="182.5" x2="426.5" y1="192.9958" y2="192.9958"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="226" x="189.5" y="187.1868">POST /areas {action, reactions, config}</text><polygon fill="#A80036" points="571.5,220.7018,581.5,224.7018,571.5,228.7018,575.5,224.7018" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="432.5" x2="577.5" y1="224.7018" y2="224.7018"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="72" x="439.5" y="218.8928">INSERT area</text><polygon fill="#A80036" points="443.5,252.4078,433.5,256.4078,443.5,260.4078,439.5,256.4078" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="437.5" x2="582.5" y1="256.4078" y2="256.4078"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="43" x="449.5" y="250.5988">area_id</text><polygon fill="#A80036" points="193.5,284.1138,183.5,288.1138,193.5,292.1138,189.5,288.1138" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="187.5" x2="431.5" y1="288.1138" y2="288.1138"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="127" x="199.5" y="282.3048">201 Created {area_id}</text><polygon fill="#A80036" points="37.5,315.8199,27.5,319.8199,37.5,323.8199,33.5,319.8199" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="31.5" x2="181.5" y1="319.8199" y2="319.8199"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="112" x="43.5" y="314.0109">show confirmation</text><path d="M278,332.8199 L278,359.8199 L583,359.8199 L583,342.8199 L573,332.8199 L278,332.8199 " fill="#FBFB77" filter="url(#f1smdt1z92i7ki)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M573,332.8199 L573,342.8199 L583,342.8199 L573,332.8199 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="284" x="284" y="351.7169">Background scheduler (hooks) periodically polls</text><path d="M342,376.5259 L415,376.5259 L415,385.5259 L405,395.5259 L342,395.5259 L342,376.5259 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="320.0602" style="stroke: #000000; stroke-width: 2.0;" width="520.5" x="342" y="376.5259"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="28" x="357" y="391.4229">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="148" x="430" y="390.2848">[every N seconds/minutes]</text><polygon fill="#A80036" points="742.5,415.9379,752.5,419.9379,742.5,423.9379,746.5,419.9379" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="432.5" x2="748.5" y1="419.9379" y2="419.9379"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="298" x="439.5" y="414.1289">poll for action events (for connected user services)</text><polygon fill="#A80036" points="443.5,447.6439,433.5,451.6439,443.5,455.6439,439.5,451.6439" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="437.5" x2="753.5" y1="451.6439" y2="451.6439"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="107" x="449.5" y="445.8349">event data (if any)</text><path d="M352,466.6439 L415,466.6439 L415,475.6439 L405,485.6439 L352,485.6439 L352,466.6439 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="222.9421" style="stroke: #000000; stroke-width: 2.0;" width="500.5" x="352" y="466.6439"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="367" y="481.5409">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="178" x="430" y="480.4028">[event matches AREA condition]</text><polygon fill="#A80036" points="571.5,506.056,581.5,510.056,571.5,514.056,575.5,510.056" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="432.5" x2="577.5" y1="510.056" y2="510.056"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="127" x="439.5" y="504.247">fetch AREA(s) for user</text><polygon fill="#A80036" points="443.5,537.762,433.5,541.762,443.5,545.762,439.5,541.762" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="437.5" x2="582.5" y1="541.762" y2="541.762"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="32" x="449.5" y="535.953">areas</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="432.5" x2="474.5" y1="573.468" y2="573.468"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="474.5" x2="474.5" y1="573.468" y2="586.468"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="433.5" x2="474.5" y1="586.468" y2="586.468"/><polygon fill="#A80036" points="443.5,582.468,433.5,586.468,443.5,590.468,439.5,586.468" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="103" x="439.5" y="567.659">trigger REActions</text><polygon fill="#A80036" points="742.5,614.174,752.5,618.174,742.5,622.174,746.5,618.174" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="432.5" x2="748.5" y1="618.174" y2="618.174"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="218" x="439.5" y="612.365">call external API to perform REAction</text><polygon fill="#A80036" points="443.5,645.88,433.5,649.88,443.5,653.88,439.5,649.88" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="437.5" x2="753.5" y1="649.88" y2="649.88"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="42" x="449.5" y="644.071">200 OK</text><polygon fill="#A80036" points="571.5,677.586,581.5,681.586,571.5,685.586,575.5,681.586" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="432.5" x2="577.5" y1="681.586" y2="681.586"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="81" x="439.5" y="675.777">log execution</text><!--MD5=[5b8546c8c535a919b5380f48c4e22f68]
@startuml
title Architecture - High Level Sequence
actor "User" as U
participant "WebClient" as WC
participant "MobileClient" as MC
participant "Application Server" as S
participant "Database" as DB
participant "ExternalService (OAuth)" as ES

U -> WC: open UI / Create AREA
WC -> S: POST /areas {action, reactions, config}
S -> DB: INSERT area
DB - -> S: area_id
S - -> WC: 201 Created {area_id}
WC - -> U: show confirmation

note over S: Background scheduler (hooks) periodically polls

loop every N seconds/minutes
    S -> ES: poll for action events (for connected user services)
    ES - -> S: event data (if any)
    alt event matches AREA condition
        S -> DB: fetch AREA(s) for user
        DB - -> S: areas
        S -> S: trigger REActions
        S -> ES: call external API to perform REAction
        ES - -> S: 200 OK
        S -> DB: log execution
    end
end
@enduml

PlantUML version 1.2020.02(Sun Mar 01 11:22:07 CET 2020)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 21.0.8+9-Ubuntu-0ubuntu124.04.1
Operating System: Linux
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>