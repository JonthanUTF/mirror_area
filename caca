# Guide d'ImplÃ©mentation Projet AREA

## ğŸ“ Structure du Projet

```
area-project/
â”œâ”€â”€ docker-compose.yml
â”œâ”€â”€ .env.example
â”œâ”€â”€ README.md
â”œâ”€â”€ HOWTOCONTRIBUTE.md
â”œâ”€â”€ docs/
â”‚   â”œâ”€â”€ architecture.md
â”‚   â”œâ”€â”€ api-reference.md
â”‚   â””â”€â”€ diagrams/
â”‚
â”œâ”€â”€ server/
â”‚   â”œâ”€â”€ Dockerfile
â”‚   â”œâ”€â”€ package.json
â”‚   â”œâ”€â”€ tsconfig.json
â”‚   â”œâ”€â”€ nest-cli.json
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ main.ts
â”‚   â”‚   â”œâ”€â”€ app.module.ts
â”‚   â”‚   â”œâ”€â”€ config/
â”‚   â”‚   â”‚   â”œâ”€â”€ database.config.ts
â”‚   â”‚   â”‚   â””â”€â”€ oauth.config.ts
â”‚   â”‚   â”œâ”€â”€ auth/
â”‚   â”‚   â”‚   â”œâ”€â”€ auth.module.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ auth.service.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ auth.controller.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ strategies/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ jwt.strategy.ts
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ google.strategy.ts
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ github.strategy.ts
â”‚   â”‚   â”‚   â””â”€â”€ guards/
â”‚   â”‚   â”‚       â””â”€â”€ jwt-auth.guard.ts
â”‚   â”‚   â”œâ”€â”€ users/
â”‚   â”‚   â”‚   â”œâ”€â”€ users.module.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ users.service.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ users.controller.ts
â”‚   â”‚   â”‚   â””â”€â”€ entities/
â”‚   â”‚   â”‚       â””â”€â”€ user.entity.ts
â”‚   â”‚   â”œâ”€â”€ services/
â”‚   â”‚   â”‚   â”œâ”€â”€ services.module.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ services.service.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ services.controller.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ entities/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ service.entity.ts
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ user-service.entity.ts
â”‚   â”‚   â”‚   â””â”€â”€ adapters/
â”‚   â”‚   â”‚       â”œâ”€â”€ base.adapter.ts
â”‚   â”‚   â”‚       â”œâ”€â”€ github.adapter.ts
â”‚   â”‚   â”‚       â”œâ”€â”€ gmail.adapter.ts
â”‚   â”‚   â”‚       â”œâ”€â”€ drive.adapter.ts
â”‚   â”‚   â”‚       â”œâ”€â”€ discord.adapter.ts
â”‚   â”‚   â”‚       â”œâ”€â”€ weather.adapter.ts
â”‚   â”‚   â”‚       â””â”€â”€ timer.adapter.ts
â”‚   â”‚   â”œâ”€â”€ areas/
â”‚   â”‚   â”‚   â”œâ”€â”€ areas.module.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ areas.service.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ areas.controller.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ entities/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ area.entity.ts
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ action.entity.ts
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ reaction.entity.ts
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ area-execution.entity.ts
â”‚   â”‚   â”‚   â””â”€â”€ dto/
â”‚   â”‚   â”‚       â”œâ”€â”€ create-area.dto.ts
â”‚   â”‚   â”‚       â””â”€â”€ update-area.dto.ts
â”‚   â”‚   â”œâ”€â”€ hooks/
â”‚   â”‚   â”‚   â”œâ”€â”€ hooks.module.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ hooks.service.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ scheduler.service.ts
â”‚   â”‚   â”‚   â””â”€â”€ processors/
â”‚   â”‚   â”‚       â””â”€â”€ hook.processor.ts
â”‚   â”‚   â”œâ”€â”€ about/
â”‚   â”‚   â”‚   â”œâ”€â”€ about.controller.ts
â”‚   â”‚   â”‚   â””â”€â”€ about.service.ts
â”‚   â”‚   â””â”€â”€ common/
â”‚   â”‚       â”œâ”€â”€ filters/
â”‚   â”‚       â”œâ”€â”€ interceptors/
â”‚   â”‚       â””â”€â”€ decorators/
â”‚   â””â”€â”€ test/
â”‚
â”œâ”€â”€ client-web/
â”‚   â”œâ”€â”€ Dockerfile
â”‚   â”œâ”€â”€ package.json
â”‚   â”œâ”€â”€ vite.config.ts
â”‚   â”œâ”€â”€ tsconfig.json
â”‚   â”œâ”€â”€ index.html
â”‚   â”œâ”€â”€ public/
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ main.tsx
â”‚   â”‚   â”œâ”€â”€ App.tsx
â”‚   â”‚   â”œâ”€â”€ api/
â”‚   â”‚   â”‚   â”œâ”€â”€ client.ts
â”‚   â”‚   â”‚   â””â”€â”€ endpoints.ts
â”‚   â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â”‚   â”œâ”€â”€ auth/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ LoginForm.tsx
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ RegisterForm.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ areas/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ AreaList.tsx
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ AreaCard.tsx
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ AreaForm.tsx
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ AreaBuilder.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ services/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ ServiceList.tsx
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ ServiceCard.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ layout/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ Header.tsx
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ Sidebar.tsx
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ Footer.tsx
â”‚   â”‚   â”‚   â””â”€â”€ common/
â”‚   â”‚   â”‚       â”œâ”€â”€ Button.tsx
â”‚   â”‚   â”‚       â”œâ”€â”€ Input.tsx
â”‚   â”‚   â”‚       â””â”€â”€ Modal.tsx
â”‚   â”‚   â”œâ”€â”€ pages/
â”‚   â”‚   â”‚   â”œâ”€â”€ Home.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ Login.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ Register.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ Dashboard.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ Areas.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ Services.tsx
â”‚   â”‚   â”‚   â””â”€â”€ Profile.tsx
â”‚   â”‚   â”œâ”€â”€ store/
â”‚   â”‚   â”‚   â”œâ”€â”€ auth.store.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ areas.store.ts
â”‚   â”‚   â”‚   â””â”€â”€ services.store.ts
â”‚   â”‚   â”œâ”€â”€ hooks/
â”‚   â”‚   â”‚   â”œâ”€â”€ useAuth.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ useAreas.ts
â”‚   â”‚   â”‚   â””â”€â”€ useServices.ts
â”‚   â”‚   â””â”€â”€ utils/
â”‚   â”‚       â”œâ”€â”€ constants.ts
â”‚   â”‚       â””â”€â”€ helpers.ts
â”‚   â””â”€â”€ nginx.conf
â”‚
â””â”€â”€ client-mobile/
    â”œâ”€â”€ Dockerfile
    â”œâ”€â”€ package.json
    â”œâ”€â”€ tsconfig.json
    â”œâ”€â”€ app.json
    â”œâ”€â”€ metro.config.js
    â”œâ”€â”€ App.tsx
    â”œâ”€â”€ src/
    â”‚   â”œâ”€â”€ navigation/
    â”‚   â”‚   â””â”€â”€ AppNavigator.tsx
    â”‚   â”œâ”€â”€ screens/
    â”‚   â”‚   â”œâ”€â”€ LoginScreen.tsx
    â”‚   â”‚   â”œâ”€â”€ RegisterScreen.tsx
    â”‚   â”‚   â”œâ”€â”€ DashboardScreen.tsx
    â”‚   â”‚   â”œâ”€â”€ AreasScreen.tsx
    â”‚   â”‚   â”œâ”€â”€ CreateAreaScreen.tsx
    â”‚   â”‚   â”œâ”€â”€ ServicesScreen.tsx
    â”‚   â”‚   â””â”€â”€ ProfileScreen.tsx
    â”‚   â”œâ”€â”€ components/
    â”‚   â”‚   â”œâ”€â”€ AreaCard.tsx
    â”‚   â”‚   â”œâ”€â”€ ServiceCard.tsx
    â”‚   â”‚   â””â”€â”€ common/
    â”‚   â”œâ”€â”€ api/
    â”‚   â”‚   â””â”€â”€ client.ts
    â”‚   â”œâ”€â”€ store/
    â”‚   â””â”€â”€ utils/
    â””â”€â”€ android/
```

## ğŸ³ Configuration Docker

### docker-compose.yml

```yaml
version: '3.8'

services:
  # Base de donnÃ©es PostgreSQL
  postgres:
    image: postgres:15-alpine
    container_name: area_postgres
    environment:
      POSTGRES_DB: area_db
      POSTGRES_USER: area_user
      POSTGRES_PASSWORD: area_password
    ports:
      - "5432:5432"
    volumes:
      - postgres_data:/var/lib/postgresql/data
    networks:
      - area_network
    healthcheck:
      test: ["CMD-SHELL", "pg_isready -U area_user"]
      interval: 10s
      timeout: 5s
      retries: 5

  # Cache Redis
  redis:
    image: redis:7-alpine
    container_name: area_redis
    ports:
      - "6379:6379"
    networks:
      - area_network
    healthcheck:
      test: ["CMD", "redis-cli", "ping"]
      interval: 10s
      timeout: 5s
      retries: 5

  # Serveur d'application NestJS
  server:
    build:
      context: ./server
      dockerfile: Dockerfile
    container_name: area_server
    ports:
      - "8080:8080"
    environment:
      NODE_ENV: production
      PORT: 8080
      DATABASE_URL: postgresql://area_user:area_password@postgres:5432/area_db
      REDIS_URL: redis://redis:6379
      JWT_SECRET: ${JWT_SECRET}
      GOOGLE_CLIENT_ID: ${GOOGLE_CLIENT_ID}
      GOOGLE_CLIENT_SECRET: ${GOOGLE_CLIENT_SECRET}
      GITHUB_CLIENT_ID: ${GITHUB_CLIENT_ID}
      GITHUB_CLIENT_SECRET: ${GITHUB_CLIENT_SECRET}
    depends_on:
      postgres:
        condition: service_healthy
      redis:
        condition: service_healthy
    networks:
      - area_network
    volumes:
      - ./server/logs:/app/logs

  # Client mobile - Build APK
  client_mobile:
    build:
      context: ./client-mobile
      dockerfile: Dockerfile
    container_name: area_mobile_builder
    volumes:
      - mobile_builds:/app/android/app/build/outputs
      - shared_volume:/shared
    networks:
      - area_network
    command: sh -c "npm run build:android && cp android/app/build/outputs/apk/release/app-release.apk /shared/client.apk"

  # Client web - Serveur Nginx
  client_web:
    build:
      context: ./client-web
      dockerfile: Dockerfile
    container_name: area_web
    ports:
      - "8081:80"
    environment:
      VITE_API_URL: http://localhost:8080
    depends_on:
      - server
      - client_mobile
    networks:
      - area_network
    volumes:
      - shared_volume:/usr/share/nginx/html/downloads

volumes:
  postgres_data:
  mobile_builds:
  shared_volume:

networks:
  area_network:
    driver: bridge
```

## ğŸ“ Fichiers Dockerfile

### server/Dockerfile

```dockerfile
# Build stage
FROM node:18-alpine AS builder

WORKDIR /app

COPY package*.json ./
RUN npm ci

COPY . .
RUN npm run build

# Production stage
FROM node:18-alpine

WORKDIR /app

COPY package*.json ./
RUN npm ci --only=production

COPY --from=builder /app/dist ./dist

EXPOSE 8080

CMD ["node", "dist/main"]
```

### client-web/Dockerfile

```dockerfile
# Build stage
FROM node:18-alpine AS builder

WORKDIR /app

COPY package*.json ./
RUN npm ci

COPY . .
RUN npm run build

# Production stage
FROM nginx:alpine

COPY --from=builder /app/dist /usr/share/nginx/html
COPY nginx.conf /etc/nginx/conf.d/default.conf

EXPOSE 80

CMD ["nginx", "-g", "daemon off;"]
```

### client-mobile/Dockerfile

```dockerfile
FROM node:18

# Install Java, Android SDK
RUN apt-get update && apt-get install -y \
    openjdk-11-jdk \
    wget \
    unzip \
    && rm -rf /var/lib/apt/lists/*

# Install Android SDK
ENV ANDROID_SDK_ROOT=/opt/android-sdk
RUN mkdir -p ${ANDROID_SDK_ROOT}/cmdline-tools && \
    wget https://dl.google.com/android/repository/commandlinetools-linux-9477386_latest.zip && \
    unzip commandlinetools-linux-9477386_latest.zip -d ${ANDROID_SDK_ROOT}/cmdline-tools && \
    mv ${ANDROID_SDK_ROOT}/cmdline-tools/cmdline-tools ${ANDROID_SDK_ROOT}/cmdline-tools/latest && \
    rm commandlinetools-linux-9477386_latest.zip

ENV PATH=${PATH}:${ANDROID_SDK_ROOT}/cmdline-tools/latest/bin:${ANDROID_SDK_ROOT}/platform-tools

# Accept licenses and install build tools
RUN yes | sdkmanager --licenses && \
    sdkmanager "platform-tools" "platforms;android-33" "build-tools;33.0.0"

WORKDIR /app

COPY package*.json ./
RUN npm ci

COPY . .

# Build APK
RUN cd android && ./gradlew assembleRelease

VOLUME ["/shared"]
```

## ğŸš€ Commandes de DÃ©marrage

### DÃ©veloppement

```bash
# Cloner le repository
git clone <repo-url>
cd area-project

# CrÃ©er le fichier .env
cp .env.example .env
# Ã‰diter .env avec vos clÃ©s API

# Lancer la base de donnÃ©es
docker-compose up -d postgres redis

# Backend - Terminal 1
cd server
npm install
npm run start:dev

# Frontend Web - Terminal 2
cd client-web
npm install
npm run dev

# Mobile - Terminal 3
cd client-mobile
npm install
npm run android  # ou npm run ios
```

### Production

```bash
# Build tous les services
docker-compose build

# Lancer tous les services
docker-compose up -d

# VÃ©rifier les logs
docker-compose logs -f server

# ArrÃªter
docker-compose down

# ArrÃªter et supprimer les volumes
docker-compose down -v
```

### Tests

```bash
# Tests backend
cd server
npm run test
npm run test:e2e
npm run test:cov

# Tests frontend
cd client-web
npm run test

# Linter
npm run lint
```

## ğŸ”‘ Variables d'Environnement

### .env.example

```env
# Database
DATABASE_URL=postgresql://area_user:area_password@localhost:5432/area_db
REDIS_URL=redis://localhost:6379

# JWT
JWT_SECRET=your-super-secret-jwt-key-change-in-production
JWT_EXPIRATION=7d

# OAuth2 - Google
GOOGLE_CLIENT_ID=your-google-client-id
GOOGLE_CLIENT_SECRET=your-google-client-secret
GOOGLE_CALLBACK_URL=http://localhost:8080/auth/google/callback

# OAuth2 - GitHub
GITHUB_CLIENT_ID=your-github-client-id
GITHUB_CLIENT_SECRET=your-github-client-secret
GITHUB_CALLBACK_URL=http://localhost:8080/auth/github/callback

# OAuth2 - Facebook (optionnel)
FACEBOOK_CLIENT_ID=your-facebook-app-id
FACEBOOK_CLIENT_SECRET=your-facebook-app-secret

# APIs Externes
DISCORD_BOT_TOKEN=your-discord-bot-token
WEATHER_API_KEY=your-openweathermap-api-key

# Frontend
VITE_API_URL=http://localhost:8080
VITE_GOOGLE_CLIENT_ID=your-google-client-id

# Mobile
REACT_NATIVE_API_URL=http://10.0.2.2:8080
```

## ğŸ“š Scripts NPM Utiles

### Backend (server/package.json)

```json
{
  "scripts": {
    "start": "nest start",
    "start:dev": "nest start --watch",
    "start:debug": "nest start --debug --watch",
    "start:prod": "node dist/main",
    "build": "nest build",
    "test": "jest",
    "test:watch": "jest --watch",
    "test:cov": "jest --coverage",
    "test:e2e": "jest --config ./test/jest-e2e.json",
    "lint": "eslint \"{src,apps,libs,test}/**/*.ts\" --fix",
    "format": "prettier --write \"src/**/*.ts\"",
    "migration:generate": "typeorm migration:generate -n",
    "migration:run": "typeorm migration:run",
    "seed": "ts-node src/database/seeds/run-seed.ts"
  }
}
```

### Frontend (client-web/package.json)

```json
{
  "scripts": {
    "dev": "vite",
    "build": "tsc && vite build",
    "preview": "vite preview",
    "lint": "eslint . --ext ts,tsx --report-unused-disable-directives --max-warnings 0",
    "format": "prettier --write \"src/**/*.{ts,tsx}\""
  }
}
```

### Mobile (client-mobile/package.json)

```json
{
  "scripts": {
    "start": "react-native start",
    "android": "react-native run-android",
    "ios": "react-native run-ios",
    "build:android": "cd android && ./gradlew assembleRelease",
    "lint": "eslint . --ext .js,.jsx,.ts,.tsx"
  }
}
```

## ğŸ§ª POCs Ã  RÃ©aliser (Milestone 1)

### 1. POC NestJS + TypeORM

```bash
# CrÃ©er un nouveau projet
nest new area-server
cd area-server

# Installer dÃ©pendances
npm install @nestjs/typeorm typeorm pg
npm install @nestjs/config

# CrÃ©er un module simple
nest g module users
nest g service users
nest g controller users

# Tester la connexion DB et une route CRUD
```

### 2. POC OAuth2 Google

```bash
npm install @nestjs/passport passport passport-google-oauth20
npm install -D @types/passport-google-oauth20

# ImplÃ©menter GoogleStrategy
# Tester le flow OAuth complet
```

### 3. POC React + API Call

```bash
npm create vite@latest area-web -- --template react-ts
cd area-web
npm install axios zustand react-router-dom

# CrÃ©er un composant qui appelle l'API NestJS
# Tester l'affichage des donnÃ©es
```

### 4. POC React Native

```bash
npx react-native init AreaMobile --template react-native-template-typescript
cd AreaMobile

# Installer navigation
npm install @react-navigation/native @react-navigation/stack
npm install react-native-screens react-native-safe-area-context

# CrÃ©er 2-3 Ã©crans de navigation
npm run android
```

### 5. POC Hooks System

```bash
# Dans le backend
npm install @nestjs/schedule @nestjs/bull bull

# CrÃ©er un cron job simple qui vÃ©rifie une condition
# Tester l'exÃ©cution toutes les minutes
```

---

## ğŸ“– Ressources Utiles

- [Documentation NestJS](https://docs.nestjs.com/)
- [Documentation React](https://react.dev/)
- [Documentation React Native](https://reactnative.dev/)
- [TypeORM Documentation](https://typeorm.io/)
- [Docker Compose Documentation](https://docs.docker.com/compose/)
- [OAuth 2.0 Guide](https://oauth.net/2/)

## ğŸ¯ Checklist Milestone 1

- [ ] POC NestJS + DB fonctionne
- [ ] POC OAuth2 Google rÃ©ussi
- [ ] POC React avec appels API
- [ ] POC React Native avec navigation
- [ ] docker-compose.yml crÃ©Ã©
- [ ] Diagramme ER de la base de donnÃ©es
- [ ] Diagramme de classes
- [ ] Planning Trello/Jira configurÃ©
- [ ] Repository Git avec branches
- [ ] README.md initial